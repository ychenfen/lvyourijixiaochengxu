<!--ç®¡ç†å‘˜åå°é¡µ-->
<view class="page">
  <!-- é¡¶éƒ¨æ ‡ç­¾ -->
  <view class="tabs">
    <view class="tab {{activeTab === 'stats' ? 'active' : ''}}" bindtap="switchTab" data-tab="stats">æ•°æ®ç»Ÿè®¡</view>
    <view class="tab {{activeTab === 'users' ? 'active' : ''}}" bindtap="switchTab" data-tab="users">ç”¨æˆ·ç®¡ç†</view>
    <view class="tab {{activeTab === 'content' ? 'active' : ''}}" bindtap="switchTab" data-tab="content">å†…å®¹å®¡æ ¸</view>
  </view>

  <!-- æ•°æ®ç»Ÿè®¡ -->
  <view class="tab-content" wx:if="{{activeTab === 'stats'}}">
    <view class="stats-grid">
      <view class="stats-card">
        <text class="stats-icon">ğŸ‘¥</text>
        <text class="stats-value">{{stats.totalUsers}}</text>
        <text class="stats-label">æ€»ç”¨æˆ·æ•°</text>
      </view>
      <view class="stats-card">
        <text class="stats-icon">ğŸ“”</text>
        <text class="stats-value">{{stats.totalDiaries}}</text>
        <text class="stats-label">æ€»æ—¥è®°æ•°</text>
      </view>
      <view class="stats-card">
        <text class="stats-icon">ğŸ“</text>
        <text class="stats-value">{{stats.totalFootprints}}</text>
        <text class="stats-label">æ€»è¶³è¿¹æ•°</text>
      </view>
      <view class="stats-card">
        <text class="stats-icon">ğŸ“…</text>
        <text class="stats-value">{{stats.todayDiaries}}</text>
        <text class="stats-label">ä»Šæ—¥æ–°å¢æ—¥è®°</text>
      </view>
      <view class="stats-card">
        <text class="stats-icon">ğŸ†•</text>
        <text class="stats-value">{{stats.todayUsers}}</text>
        <text class="stats-label">ä»Šæ—¥æ–°å¢ç”¨æˆ·</text>
      </view>
      <view class="stats-card">
        <text class="stats-icon">ğŸ”¥</text>
        <text class="stats-value">{{stats.activeUsers}}</text>
        <text class="stats-label">æ´»è·ƒç”¨æˆ·</text>
      </view>
    </view>
  </view>

  <!-- ç”¨æˆ·ç®¡ç† -->
  <view class="tab-content" wx:if="{{activeTab === 'users'}}">
    <!-- æœç´¢æ  -->
    <view class="search-bar">
      <input class="search-input" placeholder="æœç´¢ç”¨æˆ·" value="{{userSearch}}" bindinput="onUserSearchInput"/>
      <text class="search-btn" bindtap="searchUsers">æœç´¢</text>
    </view>
    
    <!-- ç”¨æˆ·åˆ—è¡¨ -->
    <view class="user-list">
      <view class="user-item" wx:for="{{users}}" wx:key="id">
        <image class="user-avatar" src="{{item.avatar || '/images/default-avatar.png'}}" mode="aspectFill"></image>
        <view class="user-info">
          <text class="user-name">{{item.name || 'æœªçŸ¥ç”¨æˆ·'}}</text>
          <text class="user-meta">æ³¨å†Œæ—¶é—´ï¼š{{item.createdAt}}</text>
          <text class="user-meta">æ—¥è®°æ•°ï¼š{{item.diaryCount}}</text>
        </view>
        <view class="user-actions">
          <view class="status-tag {{item.status === 'active' ? 'active' : 'disabled'}}">
            {{item.status === 'active' ? 'æ­£å¸¸' : 'å·²ç¦ç”¨'}}
          </view>
          <button 
            class="action-btn {{item.status === 'active' ? 'danger' : 'success'}}" 
            bindtap="toggleUserStatus" 
            data-id="{{item.id}}"
            data-status="{{item.status}}"
          >
            {{item.status === 'active' ? 'ç¦ç”¨' : 'å¯ç”¨'}}
          </button>
        </view>
      </view>
      <view class="empty-tip" wx:if="{{users.length === 0}}">
        <text>æš‚æ— ç”¨æˆ·æ•°æ®</text>
      </view>
    </view>
  </view>

  <!-- å†…å®¹å®¡æ ¸ -->
  <view class="tab-content" wx:if="{{activeTab === 'content'}}">
    <!-- ç­›é€‰ -->
    <view class="filter-bar">
      <view class="filter-item {{contentFilter === 'all' ? 'active' : ''}}" bindtap="setContentFilter" data-filter="all">å…¨éƒ¨</view>
      <view class="filter-item {{contentFilter === 'pending' ? 'active' : ''}}" bindtap="setContentFilter" data-filter="pending">å¾…å®¡æ ¸</view>
      <view class="filter-item {{contentFilter === 'blocked' ? 'active' : ''}}" bindtap="setContentFilter" data-filter="blocked">å·²å±è”½</view>
    </view>
    
    <!-- æ—¥è®°åˆ—è¡¨ -->
    <view class="diary-list">
      <view class="diary-item" wx:for="{{diaries}}" wx:key="id">
        <view class="diary-header">
          <text class="diary-title">{{item.title}}</text>
          <view class="status-tag {{item.status === 'normal' ? 'active' : item.status === 'pending' ? 'warning' : 'danger'}}">
            {{item.status === 'normal' ? 'æ­£å¸¸' : item.status === 'pending' ? 'å¾…å®¡æ ¸' : 'å·²å±è”½'}}
          </view>
        </view>
        <text class="diary-content">{{item.content}}</text>
        <view class="diary-meta">
          <text>ä½œè€…ï¼š{{item.authorName}}</text>
          <text>å‘å¸ƒæ—¶é—´ï¼š{{item.createdAt}}</text>
        </view>
        <view class="diary-actions">
          <button class="action-btn" bindtap="viewDiary" data-id="{{item.id}}">æŸ¥çœ‹</button>
          <button 
            class="action-btn {{item.status === 'blocked' ? 'success' : 'warning'}}" 
            bindtap="toggleDiaryStatus" 
            data-id="{{item.id}}"
            data-status="{{item.status}}"
          >
            {{item.status === 'blocked' ? 'æ¢å¤' : 'å±è”½'}}
          </button>
          <button class="action-btn danger" bindtap="deleteDiary" data-id="{{item.id}}">åˆ é™¤</button>
        </view>
      </view>
      <view class="empty-tip" wx:if="{{diaries.length === 0}}">
        <text>æš‚æ— æ—¥è®°æ•°æ®</text>
      </view>
    </view>
  </view>
</view>
